{"version":3,"file":"auth-DJ_g7L93.js","sources":["../../node_modules/react/cjs/react-jsx-runtime.production.min.js","../../node_modules/react/jsx-runtime.js","../../src/contexts/AuthContext.jsx"],"sourcesContent":["/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","import React, { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n  const fetchUser = useCallback(async (token) => {\r\n    if (!token) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const response = await fetch('/api/auth/me', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setUser(data.user);\r\n      } else {\r\n        setUser(null);\r\n        localStorage.removeItem('token');\r\n        navigate('/login');\r\n      }\r\n    } catch (error) {\r\n      console.error('AuthContext fetch user error:', error);\r\n      setUser(null);\r\n      localStorage.removeItem('token');\r\n      navigate('/login');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [navigate]);\r\n\r\n  const logout = useCallback(() => {\r\n    setUser(null);\r\n    localStorage.removeItem('token');\r\n    navigate('/login');\r\n  }, [navigate]);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    fetchUser(token);\r\n  }, [fetchUser]);\r\n\r\n  const login = useCallback(async (username, password) => {\r\n    try {\r\n      const response = await fetch('/api/auth/login', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ username, password })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (response.ok) {\r\n        localStorage.setItem('token', data.token);\r\n        setUser(data.user);\r\n        navigate('/tasks');\r\n        return { success: true };\r\n      } else {\r\n        return { success: false, error: data.error };\r\n      }\r\n    } catch (error) {\r\n      console.error('Error during login:', error);\r\n      return { success: false, error: 'Server error' };\r\n    }\r\n  }, [navigate]);\r\n\r\n  const register = useCallback(async (username, password) => {\r\n    try {\r\n      const response = await fetch('/api/auth/register', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({ username, password })\r\n      });\r\n\r\n      const data = await response.json();\r\n      \r\n      if (response.ok) {\r\n        localStorage.setItem('token', data.token);\r\n        setUser(data.user);\r\n        navigate('/tasks');\r\n        return { success: true };\r\n      } else {\r\n        return { success: false, error: data.error };\r\n      }\r\n    } catch (error) {\r\n      console.error('Error during registration:', error);\r\n      return { success: false, error: 'Server error' };\r\n    }\r\n  }, [navigate]);\r\n\r\n  const value = useMemo(() => ({\r\n    user,\r\n    loading,\r\n    login,\r\n    logout,\r\n    register,\r\n    fetchUser\r\n  }), [user, loading, login, logout, register, fetchUser]);\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}; "],"names":["f","require$$0","k","l","m","n","p","q","c","a","g","b","d","e","h","reactJsxRuntime_production_min","jsxRuntimeModule","AuthContext","createContext","useAuth","context","useContext","AuthProvider","children","user","setUser","useState","loading","setLoading","navigate","useNavigate","fetchUser","useCallback","token","response","data","error","logout","useEffect","login","username","password","register","value","useMemo","jsx"],"mappings":"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","x_google_ignoreList":[0,1]}