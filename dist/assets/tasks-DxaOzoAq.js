import{u as T,j as y}from"./auth-DJ_g7L93.js";import{r as o}from"./vendor-DDy6G2mo.js";const p=o.createContext(null);function x({children:c}){const[u,s]=o.useState([]),[k,l]=o.useState(!0),{user:f}=T(),i=o.useCallback(async()=>{if(!f){s([]),l(!1);return}l(!0);try{const t=localStorage.getItem("token");if(!t)return;const e=await fetch("/api/tasks",{headers:{Authorization:`Bearer ${t}`}});if(e.ok){const a=await e.json();s(a)}else s([])}catch(t){console.error("Error fetching tasks:",t),s([])}finally{l(!1)}},[f]),h=o.useCallback(async t=>{try{const e=localStorage.getItem("token");if(!e)return;const a=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({title:t})});if(a.ok){const n=await a.json();return s(r=>[...r,n]),n}}catch(e){console.error("Error adding task:",e)}},[]),d=o.useCallback(async t=>{try{const e=localStorage.getItem("token");if(!e)return;(await fetch(`/api/tasks/${t}/toggle`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`}})).ok&&s(n=>n.map(r=>r._id===t?{...r,completed:!r.completed}:r))}catch(e){console.error("Error toggling task:",e)}},[]),g=o.useCallback(async t=>{try{const e=localStorage.getItem("token");if(!e)return;(await fetch(`/api/tasks/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})).ok&&s(n=>n.filter(r=>r._id!==t))}catch(e){console.error("Error deleting task:",e)}},[]);o.useEffect(()=>{i()},[i]);const m=o.useMemo(()=>({tasks:u,loading:k,fetchTasks:i,addTask:h,toggleTask:d,deleteTask:g}),[u,k,i,h,d,g]);return y.jsx(p.Provider,{value:m,children:c})}function C(){const c=o.useContext(p);if(!c)throw new Error("useTasks must be used within a TasksProvider");return c}export{x as T,C as u};
//# sourceMappingURL=tasks-DxaOzoAq.js.map
