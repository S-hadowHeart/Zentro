{"version":3,"file":"tasks-CQeckuFM.js","sources":["../../src/contexts/TasksContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst TasksContext = createContext(null);\r\n\r\nexport function TasksProvider({ children }) {\r\n  const [tasks, setTasks] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const { user } = useAuth();\r\n\r\n  const fetchTasks = useCallback(async () => {\r\n    if (!user) {\r\n      setTasks([]);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/tasks', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setTasks(data);\r\n      } else {\r\n        setTasks([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching tasks:', error);\r\n      setTasks([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  const addTask = useCallback(async (title) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/tasks', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`\r\n        },\r\n        body: JSON.stringify({ title })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const newTask = await response.json();\r\n        setTasks(prevTasks => [...prevTasks, newTask]);\r\n        return newTask;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding task:', error);\r\n    }\r\n  }, []);\r\n\r\n  const toggleTask = useCallback(async (taskId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch(`/api/tasks/${taskId}/toggle`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setTasks(prevTasks =>\r\n          prevTasks.map(task =>\r\n            task._id === taskId ? { ...task, completed: !task.completed } : task\r\n          )\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling task:', error);\r\n    }\r\n  }, []);\r\n\r\n  const deleteTask = useCallback(async (taskId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch(`/api/tasks/${taskId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setTasks(prevTasks => prevTasks.filter(task => task._id !== taskId));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting task:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, [fetchTasks]);\r\n\r\n  const value = useMemo(() => ({\r\n    tasks,\r\n    loading,\r\n    fetchTasks,\r\n    addTask,\r\n    toggleTask,\r\n    deleteTask\r\n  }), [tasks, loading, fetchTasks, addTask, toggleTask, deleteTask]);\r\n\r\n  return (\r\n    <TasksContext.Provider value={value}>\r\n      {children}\r\n    </TasksContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useTasks() {\r\n  const context = useContext(TasksContext);\r\n  if (!context) {\r\n    throw new Error('useTasks must be used within a TasksProvider');\r\n  }\r\n  return context;\r\n} "],"names":["TasksContext","createContext","TasksProvider","children","tasks","setTasks","useState","loading","setLoading","user","useAuth","fetchTasks","useCallback","token","localStorage","getItem","response","fetch","headers","ok","data","json","error","addTask","title","method","body","JSON","stringify","newTask","prevTasks","toggleTask","taskId","map","task","_id","completed","deleteTask","filter","useEffect","value","useMemo","_jsx","Provider","useTasks","context","useContext","Error"],"mappings":"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"}