{"version":3,"file":"tasks-DxaOzoAq.js","sources":["../../src/contexts/TasksContext.jsx"],"sourcesContent":["import { createContext, useContext, useState, useEffect, useCallback, useMemo } from 'react';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst TasksContext = createContext(null);\r\n\r\nexport function TasksProvider({ children }) {\r\n  const [tasks, setTasks] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const { user } = useAuth();\r\n\r\n  const fetchTasks = useCallback(async () => {\r\n    if (!user) {\r\n      setTasks([]);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/tasks', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n      \r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setTasks(data);\r\n      } else {\r\n        setTasks([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching tasks:', error);\r\n      setTasks([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  const addTask = useCallback(async (title) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch('/api/tasks', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`\r\n        },\r\n        body: JSON.stringify({ title })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const newTask = await response.json();\r\n        setTasks(prevTasks => [...prevTasks, newTask]);\r\n        return newTask;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error adding task:', error);\r\n    }\r\n  }, []);\r\n\r\n  const toggleTask = useCallback(async (taskId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch(`/api/tasks/${taskId}/toggle`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setTasks(prevTasks =>\r\n          prevTasks.map(task =>\r\n            task._id === taskId ? { ...task, completed: !task.completed } : task\r\n          )\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling task:', error);\r\n    }\r\n  }, []);\r\n\r\n  const deleteTask = useCallback(async (taskId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) return;\r\n\r\n      const response = await fetch(`/api/tasks/${taskId}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      });\r\n\r\n      if (response.ok) {\r\n        setTasks(prevTasks => prevTasks.filter(task => task._id !== taskId));\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting task:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchTasks();\r\n  }, [fetchTasks]);\r\n\r\n  const value = useMemo(() => ({\r\n    tasks,\r\n    loading,\r\n    fetchTasks,\r\n    addTask,\r\n    toggleTask,\r\n    deleteTask\r\n  }), [tasks, loading, fetchTasks, addTask, toggleTask, deleteTask]);\r\n\r\n  return (\r\n    <TasksContext.Provider value={value}>\r\n      {children}\r\n    </TasksContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useTasks() {\r\n  const context = useContext(TasksContext);\r\n  if (!context) {\r\n    throw new Error('useTasks must be used within a TasksProvider');\r\n  }\r\n  return context;\r\n} "],"names":["TasksContext","createContext","TasksProvider","children","tasks","setTasks","useState","loading","setLoading","user","useAuth","fetchTasks","useCallback","token","response","data","error","addTask","title","newTask","prevTasks","toggleTask","taskId","task","deleteTask","useEffect","value","useMemo","jsx","useTasks","context","useContext"],"mappings":"uFAGA,MAAMA,EAAeC,gBAAc,IAAI,EAEvB,SAAAC,EAAc,CAAE,SAAAC,GAAY,CAC1C,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAAA,SAAS,CAAA,CAAE,EAC/B,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAAE,KAAAG,CAAK,EAAIC,EAAQ,EAEnBC,EAAaC,EAAAA,YAAY,SAAY,CACzC,GAAI,CAACH,EAAM,CACTJ,EAAS,CAAA,CAAE,EACXG,EAAW,EAAK,EAChB,MAAA,CAGFA,EAAW,EAAI,EACX,GAAA,CACI,MAAAK,EAAQ,aAAa,QAAQ,OAAO,EAC1C,GAAI,CAACA,EAAO,OAEN,MAAAC,EAAW,MAAM,MAAM,aAAc,CACzC,QAAS,CACP,cAAiB,UAAUD,CAAK,EAAA,CAClC,CACD,EAED,GAAIC,EAAS,GAAI,CACT,MAAAC,EAAO,MAAMD,EAAS,KAAK,EACjCT,EAASU,CAAI,CAAA,MAEbV,EAAS,CAAA,CAAE,QAENW,EAAO,CACN,QAAA,MAAM,wBAAyBA,CAAK,EAC5CX,EAAS,CAAA,CAAE,CAAA,QACX,CACAG,EAAW,EAAK,CAAA,CAClB,EACC,CAACC,CAAI,CAAC,EAEHQ,EAAUL,cAAY,MAAOM,GAAU,CACvC,GAAA,CACI,MAAAL,EAAQ,aAAa,QAAQ,OAAO,EAC1C,GAAI,CAACA,EAAO,OAEN,MAAAC,EAAW,MAAM,MAAM,aAAc,CACzC,OAAQ,OACR,QAAS,CACP,eAAgB,mBAChB,cAAiB,UAAUD,CAAK,EAClC,EACA,KAAM,KAAK,UAAU,CAAE,MAAAK,CAAO,CAAA,CAAA,CAC/B,EAED,GAAIJ,EAAS,GAAI,CACT,MAAAK,EAAU,MAAML,EAAS,KAAK,EACpC,OAAAT,EAAsBe,GAAA,CAAC,GAAGA,EAAWD,CAAO,CAAC,EACtCA,CAAA,QAEFH,EAAO,CACN,QAAA,MAAM,qBAAsBA,CAAK,CAAA,CAE7C,EAAG,EAAE,EAECK,EAAaT,cAAY,MAAOU,GAAW,CAC3C,GAAA,CACI,MAAAT,EAAQ,aAAa,QAAQ,OAAO,EAC1C,GAAI,CAACA,EAAO,QAEK,MAAM,MAAM,cAAcS,CAAM,UAAW,CAC1D,OAAQ,QACR,QAAS,CACP,cAAiB,UAAUT,CAAK,EAAA,CAClC,CACD,GAEY,IACXR,KACEe,EAAU,IAAIG,GACZA,EAAK,MAAQD,EAAS,CAAE,GAAGC,EAAM,UAAW,CAACA,EAAK,WAAcA,CAAA,CAEpE,QAEKP,EAAO,CACN,QAAA,MAAM,uBAAwBA,CAAK,CAAA,CAE/C,EAAG,EAAE,EAECQ,EAAaZ,cAAY,MAAOU,GAAW,CAC3C,GAAA,CACI,MAAAT,EAAQ,aAAa,QAAQ,OAAO,EAC1C,GAAI,CAACA,EAAO,QAEK,MAAM,MAAM,cAAcS,CAAM,GAAI,CACnD,OAAQ,SACR,QAAS,CACP,cAAiB,UAAUT,CAAK,EAAA,CAClC,CACD,GAEY,IACXR,KAAsBe,EAAU,UAAeG,EAAK,MAAQD,CAAM,CAAC,QAE9DN,EAAO,CACN,QAAA,MAAM,uBAAwBA,CAAK,CAAA,CAE/C,EAAG,EAAE,EAELS,EAAAA,UAAU,IAAM,CACHd,EAAA,CAAA,EACV,CAACA,CAAU,CAAC,EAET,MAAAe,EAAQC,EAAAA,QAAQ,KAAO,CAC3B,MAAAvB,EACA,QAAAG,EACA,WAAAI,EACA,QAAAM,EACA,WAAAI,EACA,WAAAG,CAAA,GACE,CAACpB,EAAOG,EAASI,EAAYM,EAASI,EAAYG,CAAU,CAAC,EAEjE,OACGI,EAAAA,IAAA5B,EAAa,SAAb,CAAsB,MAAA0B,EACpB,SAAAvB,CACH,CAAA,CAEJ,CAEO,SAAS0B,GAAW,CACnB,MAAAC,EAAUC,aAAW/B,CAAY,EACvC,GAAI,CAAC8B,EACG,MAAA,IAAI,MAAM,8CAA8C,EAEzD,OAAAA,CACT"}